<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itboyst.facedemo.mapper.InspectSitStudentMapper">
    <resultMap id="inspectSitStudent" type="com.itboyst.facedemo.dto.InspectSitStudent">
        <id column="zid" property="zstudentID" javaType="java.lang.String"/>
        <result column="zname" property="zName" javaType="java.lang.String"/>
        <result column="grade_name" property="zgradeName" javaType="java.lang.String"/>
        <result column="zrecognizetime" property="zrecognizetime" javaType="java.sql.Timestamp"/>
        <result column="ztrainingroomID" property="ztrainingroomID" javaType="java.lang.String"/>
    </resultMap>
    <select id="findStudentByDateAndTrainingId" resultMap="inspectSitStudent" resultType="com.itboyst.facedemo.dto.InspectSitStudent">

        SELECT * FROM	(select MAX(h.zrecognizetime)as zrecognizetime,h.grade_name,h.zid,h.zname,h.ztrainingroomID from (select c.zrecognizetime,d.zid,d.zname,f.zname grade_name,b.ztrainingroomID from zstudent_login c,zstudent_schedule a,zschedule b ,zstudent d,zgrade f
						 where d.zgradeID=f.zid and b.zid=a.zscheduleID and b.ztrainingroomID='1' and d.zid=c.zstudentID and c.zstudentID=a.zstudentID  and c.zrecognizetime BETWEEN #{timestamp} and NOW()) h
						 GROUP BY h.zid) n  ORDER BY n.zrecognizetime desc



    </select>

    <select id="findStudentByDateAndTrainingIdASC" resultMap="inspectSitStudent" resultType="com.itboyst.facedemo.dto.InspectSitStudent">

        SELECT * FROM (select MAX(h.zrecognizetime) zrecognizetime ,h.grade_name,h.zid,h.zname,h.ztrainingroomID from (select c.zrecognizetime,d.zid,d.zname,f.zname grade_name,b.ztrainingroomID from zstudent_login c,zstudent_schedule a,zschedule b ,zstudent d,zgrade f
					  where d.zgradeID=f.zid and b.zid=a.zscheduleID  and d.zid=c.zstudentID and c.zstudentID=a.zstudentID  and c.zrecognizetime BETWEEN #{timestamp} and NOW()) h
	                  GROUP BY h.zid,h.ztrainingroomID) n
	    ORDER BY n.zrecognizetime desc


    </select>

    <select id="findTeacherByDateAndTrainingIdASC" resultType="com.itboyst.facedemo.dto.InspectSitTeacher">
        select a.zteacherID,b.zname as zName,b.zidentity as zgradeName,a.zrecognizetime from zteacher_login a, zteacher b where a.zteacherID=b.zid and a.zrecognizeIP ='192.168.1.156' and a.zrecognizetime between #{timestamp} and NOW()


    </select>
</mapper>